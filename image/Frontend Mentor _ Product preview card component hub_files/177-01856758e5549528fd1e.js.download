(window.cbJsonP=window.cbJsonP||[]).push([[177],{416:function(t,e,n){"use strict";n.r(e);var i=n(3),a=n.n(i),o=n(10),s=n.n(o),r=n(24),c=n.n(r),l=n(15),u=n.n(l),h=n(2),p=n.n(h),f=n(5),v=n.n(f),d=(n(29),n(14)),g=[{name:"portal",actions:[{name:"logout",method:"post",endpoint:"/api/internal/ssp_users/logout",headers:{"X-Requested-With":"XMLHttpRequest"}}]},{name:"js_info",actions:[{name:"static",method:"get",headers:{"X-Requested-With":"XMLHttpRequest"},endpoint:function(){return"/api/internal/"+Object(d.d)()+"/retrieve_js_info"},static:!0},{name:"get",method:"get",headers:{"X-Requested-With":"XMLHttpRequest"},endpoint:function(){return"/api/internal/"+Object(d.d)()+"/retrieve_js_info"},static:!1}]},{name:"locale",actions:[{name:"retrieve",method:"get",headers:{"X-Requested-With":"XMLHttpRequest"},endpoint:function(t){return"/api/internal/cbjs/"+Object(d.d)()+"/translations?locale="+t.languageCode}}]}],_=n(19),m=n(46),C=n(26),j=(v()(b,[{key:"init",value:function(){return this.apiClient.addApis(g),this.hpData={},this.infoRetrievalCount=0,this.getInfo()}},{key:"getInfo",value:function(){var n=this;return this.info?u.a.resolve(this.info):5<=this.infoRetrievalCount?u.a.resolve({site:this.config.site}):(1<this.infoRetrievalCount?this.apiClient.js_info.get():this.apiClient.js_info.static()).then(function(t){n.infoRetrievalCount=-1;var e=(n.info=t).captcha_site_key||t.recaptcha_site_key;return e&&n.commMgr.initializeCaptcha({siteKey:e,provider:t.captcha_provider,isGlobalRecaptcha:t.supported_global_recaptcha}),t}).catch(function(t){return m.a.kvl({action:"retrieve_js_info_failed",info_retrieval_count:n.infoRetrievalCount},t),u.a.resolve({site:n.config.site})}).finally(function(){return n.infoRetrievalCount++})}},{key:"syncTranslations",value:function(t){Object(C.i)(t)}},{key:"getTranslations",value:function(t){var e=this,n=0<arguments.length&&void 0!==t?t:{},i=Object(C.h)(n.locale),a=n.languageCode,o=Object(C.e)();return i?o[i]?u.a.resolve(o[i]):this.apiClient.locale.retrieve({languageCode:a}).then(function(t){return e.syncTranslations(t),t}).catch(function(t){var e=new _.a(t);throw m.a.error(e),e}):u.a.resolve(o)}},{key:"getHpData",value:function(t){return t&&c()(this.hpData[t])?s()({},t,this.hpData[t]):t?{}:this.hpData}},{key:"portalLogout",value:function(){var t=this;return this.hpData.jwt?this.apiClient.portal.logout({},{token:this.hpData.jwt}).then(function(){return{success:!(t.hpData.jwt="")}}):u.a.resolve({success:!1})}},{key:"setHpData",value:function(e){var n=this;return a()(e).map(function(t){c()(e[t])&&(n.hpData[t]=e[t])}),u.a.resolve({acknowledged:!0})}}]),b);function b(t){p()(this,b),this.config={site:t.site,hostname:t.hostName,publishableKey:t.publishableKey},this.apiClient=t.apiClient,this.iframeClient=t.connectionClient,this.commMgr=t}e.default=j}}]);
//# sourceMappingURL=177-01856758e5549528fd1e.js.map